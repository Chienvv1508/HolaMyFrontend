@page "{id:int}"
@model HolaMyFrontend.Pages.Buildings.BuildingDetailModel
@{
    ViewData["Title"] = @Model.Building.BuildingName;
}
<!-- Single Page Header start -->
<div class="container-fluid page-header py-5">
    <h1 class="text-center text-white display-6">@Model.Building.BuildingName</h1>
    <ol class="breadcrumb justify-content-center mb-0">
        <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
        <li class="breadcrumb-item"><a href="/Buildings">Tòa nhà</a></li>
        <li class="breadcrumb-item active text-white">Chi tiết</li>
    </ol>
</div>
<!-- Single Page Header End -->
<!-- Rental Detail Start -->
<div class="container-fluid">
    <div class="container py-5">
        @if (!string.IsNullOrEmpty(Model.ErrorMessage))
        {
            <div class="alert alert-danger" role="alert">
                @Model.ErrorMessage
            </div>
        }
        else
        {
            <div class="row g-4 mb-5">
                <div class="col-lg-8 col-xl-9">
                    <div class="row g-4">
                        <!-- Hình ảnh chính của tòa nhà -->

                        <div class="col-lg-6">
                            <div class="border rounded">
                                <form action="/view-image" method="GET">
                                    <input type="hidden" name="imageUrl" value="@(Model.Building.BuildingImages.FirstOrDefault(i => i.IsThumbnail == true)?.ImageUrl ?? Model.Building.BuildingImages.FirstOrDefault()?.ImageUrl ?? "/img/placeholder.jpg")">
                                    <button type="submit" class="btn p-0 border-0">
                                        <img src="@(Model.Building.BuildingImages.FirstOrDefault(i => i.IsThumbnail == true)?.ImageUrl ?? Model.Building.BuildingImages.FirstOrDefault()?.ImageUrl ?? "/img/placeholder.jpg")" class="img-fluid rounded main-image" alt="@Model.Building.BuildingName">
                                    </button>
                                </form>
                                <!-- Danh sách ảnh nhỏ từ roomimageurls -->
                                <div class="d-flex mt-2">
                                    @foreach (var image in Model.Building.BuildingImages)
                                    {
                                        <img src="@image.ImageUrl" class="img-fluid rounded me-2 thumbnail" style="width: 50px; height: 50px; cursor: pointer;" alt="@image.Description">
                                    }
                                </div>
                            </div>
                        </div>
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                const mainImage = document.querySelector('.main-image');
                                const thumbnails = document.querySelectorAll('.thumbnail');

                                thumbnails.forEach(thumbnail => {
                                    thumbnail.addEventListener('click', function () {
                                        mainImage.src = this.src; // Thay đổi src của ảnh lớn thành src của ảnh nhỏ được bấm
                                    });
                                });
                            });
                        </script>

                        <!-- Thông tin tòa nhà -->
                        <div class="col-lg-6">
                            <h4 class="fw-bold mb-3">@Model.Building.BuildingName</h4>
                            <h5 class="fw-bold mb-3">$150 / month</h5>

                            <p class="mb-3"></p>
                            <p class="mb-3"><strong>Cập nhật:</strong> @Model.Building.UpdatedHoursBefore giờ trước</p>
                            <div class="d-flex mb-2">
                                <i class="fa fa-star text-secondary"></i>
                                <i class="fa fa-star text-secondary"></i>
                                <i class="fa fa-star text-secondary"></i>
                                <i class="fa fa-star text-secondary"></i>
                                <i class="fa fa-star"></i>
                                <span class="ms-2 text-muted">(4.0 - 10 reviews)</span>
                            </div>
                            <p class="mb-2">Trạng thái: @(Model.Building.Status == 1 ? "Hoạt động" : "Không hoạt động")</p>
                            <p class="mb-2">Area: 25 m²</p>
                            <p class="mb-2">Địa chỉ: @Model.Building.AddressDetail, @Model.Building.Ward.WardName</p>
                            <p class="mb-2">Landlord: John Doe</p>
                            <p class="mb-4">Phone: +0123 456 7890</p>
                            <div class="d-flex">
                                <form action="/contact-landlord" method="POST" class="me-2">
                                    <input type="hidden" name="roomId" value="1">
                                    <input type="hidden" name="landlordId" value="1">
                                    <button type="submit" class="btn border border-secondary rounded-pill px-4 py-2 text-primary">
                                        <i class="fas fa-eye me-2 text-primary"></i> Contact Landlord
                                    </button>
                                </form>
                                <form action="/start-chat" method="POST">
                                    <input type="hidden" name="roomId" value="1">
                                    <input type="hidden" name="tenantId" value="2">
                                    <input type="hidden" name="landlordId" value="1">
                                    <button type="submit" class="btn border border-secondary rounded-pill px-4 py-2 text-primary">
                                        <i class="fas fa-comment me-2 text-primary"></i> Chat Now
                                    </button>
                                </form>
                            </div>
                        </div>

                        <!-- Mô tả và danh sách phòng -->
                        <div class="col-lg-12">
                            <nav>
                                <div class="nav nav-tabs mb-3">
                                    <button class="nav-link active border-white border-bottom-0" type="button" role="tab" id="nav-about-tab" data-bs-toggle="tab" data-bs-target="#nav-about" aria-controls="nav-about" aria-selected="true">Description</button>
                                    <button class="nav-link border-white border-bottom-0" type="button" role="tab" id="nav-reviews-tab" data-bs-toggle="tab" data-bs-target="#nav-reviews" aria-controls="nav-reviews" aria-selected="false">Reviews</button>
                                </div>
                            </nav>
                            <div class="tab-content mb-5">
                                <div class="tab-pane active" id="nav-about" role="tabpanel" aria-labelledby="nav-about-tab">
                                    <p>@Model.Building.Description</p>
                                    <div class="px-2">
                                        <div class="row g-4">
                                            <div class="col-6">
                                                <div class="row bg-light align-items-center text-center justify-content-center py-2">
                                                    <div class="col-6"><p class="mb-0">Area</p></div>
                                                    <div class="col-6"><p class="mb-0">25 m²</p></div>
                                                </div>
                                                <div class="row text-center align-items-center justify-content-center py-2">
                                                    <div class="col-6"><p class="mb-0">Location</p></div>
                                                    <div class="col-6"><p class="mb-0">123 Harmony St, Downtown</p></div>
                                                </div>
                                                <div class="row bg-light text-center align-items-center justify-content-center py-2">
                                                    <div class="col-6"><p class="mb-0">Condition</p></div>
                                                    <div class="col-6"><p class="mb-0">Furnished</p></div>
                                                </div>
                                                <div class="row text-center align-items-center justify-content-center py-2">
                                                    <div class="col-6"><p class="mb-0">Amenities</p></div>
                                                    <div class="col-6"><p class="mb-0">Wi-Fi, AC, Bathroom</p></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="nav-reviews" role="tabpanel" aria-labelledby="nav-reviews-tab">
                                    <div class="d-flex">
                                        <img src="img/avatar.jpg" class="img-fluid rounded-circle p-3" style="width: 100px; height: 100px;" alt="">
                                        <div class="">
                                            <p class="mb-2" style="font-size: 14px;">March 5, 2025</p>
                                            <div class="d-flex justify-content-between">
                                                <h5>Jason Smith</h5>
                                                <div class="d-flex mb-3">
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star"></i>
                                                </div>
                                            </div>
                                            <p class="text-dark">Great room, very comfortable and clean!</p>
                                        </div>
                                    </div>
                                    <div class="d-flex">
                                        <img src="img/avatar.jpg" class="img-fluid rounded-circle p-3" style="width: 100px; height: 100px;" alt="">
                                        <div class="">
                                            <p class="mb-2" style="font-size: 14px;">March 10, 2025</p>
                                            <div class="d-flex justify-content-between">
                                                <h5>Sam Peters</h5>
                                                <div class="d-flex mb-3">
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star"></i>
                                                    <i class="fa fa-star"></i>
                                                </div>
                                            </div>
                                            <p class="text-dark">Good location but a bit small for my needs.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <form action="/submit-review" method="POST">
                            <h4 class="mb-4 fw-bold">Leave a Review</h4>
                            <div class="mb-3">
                                <textarea class="form-control border rounded" name="comment" placeholder="Your Review *" rows="5" required></textarea>
                            </div>
                            <div class="d-flex align-items-center mb-4">
                                <p class="mb-0 me-3">Rate this:</p>
                                <div class="d-flex align-items-center rating-stars">
                                    <input type="hidden" name="rating" id="rating-value" value="0">
                                    <i class="fa fa-star text-muted" data-value="1" style="cursor: pointer;"></i>
                                    <i class="fa fa-star text-muted" data-value="2" style="cursor: pointer;"></i>
                                    <i class="fa fa-star text-muted" data-value="3" style="cursor: pointer;"></i>
                                    <i class="fa fa-star text-muted" data-value="4" style="cursor: pointer;"></i>
                                    <i class="fa fa-star text-muted" data-value="5" style="cursor: pointer;"></i>
                                </div>
                            </div>
                            <input type="hidden" name="roomId" value="1">
                            <input type="hidden" name="tenantId" value="2">
                            <button type="submit" class="btn btn-primary rounded">Submit</button>
                        </form>
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                const stars = document.querySelectorAll('.rating-stars i');
                                const ratingInput = document.getElementById('rating-value');

                                stars.forEach(star => {
                                    star.addEventListener('click', function () {
                                        const rating = this.getAttribute('data-value');
                                        ratingInput.value = rating;

                                        stars.forEach(s => {
                                            if (s.getAttribute('data-value') <= rating) {
                                                s.classList.remove('text-muted');
                                                s.classList.add('text-secondary');
                                            } else {
                                                s.classList.remove('text-secondary');
                                                s.classList.add('text-muted');
                                            }
                                        });
                                    });
                                });
                            });
                        </script>
                    </div>
                </div>
                <div class="col-lg-4 col-xl-3">
                    <div class="row g-4 fruite">
                        <div class="col-lg-12">
                            <form action="/search" method="GET">
                                <div class="input-group w-100 mx-auto d-flex mb-4">
                                    <input type="search" name="query" class="form-control p-3" placeholder="Search rentals..." aria-describedby="search-icon-1" required>
                                    <button type="submit" class="input-group-text p-3 border-0" id="search-icon-1"><i class="fa fa-search"></i></button>
                                </div>
                            </form>
                            <div class="mb-4">
                                <h4>Room Types</h4>
                                <ul class="list-unstyled fruite-categorie">
                                    <li>
                                        <div class="d-flex justify-content-between fruite-name">
                                            <form action="/filter-rooms" method="GET" class="d-inline">
                                                <input type="hidden" name="type" value="Single Room">
                                                <button type="submit" class="btn btn-link p-0"><i class="fas fa-bed me-2"></i>Single Room</button>
                                            </form>
                                            <span>(10)</span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex justify-content-between fruite-name">
                                            <form action="/filter-rooms" method="GET" class="d-inline">
                                                <input type="hidden" name="type" value="Shared Room">
                                                <button type="submit" class="btn btn-link p-0"><i class="fas fa-bed me-2"></i>Shared Room</button>
                                            </form>
                                            <span>(5)</span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex justify-content-between fruite-name">
                                            <form action="/filter-rooms" method="GET" class="d-inline">
                                                <input type="hidden" name="type" value="Apartment">
                                                <button type="submit" class="btn btn-link p-0"><i class="fas fa-home me-2"></i>Apartment</button>
                                            </form>
                                            <span>(3)</span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex justify-content-between fruite-name">
                                            <form action="/filter-rooms" method="GET" class="d-inline">
                                                <input type="hidden" name="type" value="Studio">
                                                <button type="submit" class="btn btn-link p-0"><i class="fas fa-building me-2"></i>Studio</button>
                                            </form>
                                            <span>(8)</span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <h4 class="mb-4">Featured Listings</h4>
                            <div class="d-flex align-items-center justify-content-start">
                                <div class="rounded" style="width: 100px; height: 100px;">
                                    <img src="img/featur-1.jpg" class="img-fluid rounded" alt="Cozy Single Room">
                                </div>
                                <div>
                                    <h6 class="mb-2">Cozy Single Room</h6>
                                    <div class="d-flex mb-2">
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    <div class="d-flex mb-2">
                                        <h5 class="fw-bold me-2">$150 / month</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex align-items-center justify-content-start">
                                <div class="rounded" style="width: 100px; height: 100px;">
                                    <img src="img/featur-2.jpg" class="img-fluid rounded" alt="Modern Apartment">
                                </div>
                                <div>
                                    <h6 class="mb-2">Modern Apartment</h6>
                                    <div class="d-flex mb-2">
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    <div class="d-flex mb-2">
                                        <h5 class="fw-bold me-2">$300 / month</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex align-items-center justify-content-start">
                                <div class="rounded" style="width: 100px; height: 100px;">
                                    <img src="img/featur-3.jpg" class="img-fluid rounded" alt="Compact Studio">
                                </div>
                                <div>
                                    <h6 class="mb-2">Compact Studio</h6>
                                    <div class="d-flex mb-2">
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star text-secondary"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    <div class="d-flex mb-2">
                                        <h5 class="fw-bold me-2">$200 / month</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-center my-4">
                                <form action="/featured-listings" method="GET">
                                    <button type="submit" class="btn border border-secondary px-4 py-3 rounded-pill text-primary w-100">View More</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
        
        <h1 class="fw-bold mb-0">Related Rentals</h1>
        <div class="vesitable">
            <div class="owl-carousel vegetable-carousel justify-content-center">
                <div class="border border-primary rounded position-relative vesitable-item">
                    <div class="vesitable-img">
                        <img src="img/fruite-item-2.jpg" class="img-fluid w-100 rounded-top" alt="Spacious Apartment">
                    </div>
                    <div class="text-white bg-primary px-3 py-1 rounded position-absolute" style="top: 10px; right: 10px;">Apartment</div>
                    <div class="p-4 pb-0 rounded-bottom">
                        <h4>Spacious Apartment</h4>
                        <div class="d-flex mb-2">
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star"></i>
                            <span class="ms-2 text-muted">(4.0)</span>
                        </div>
                        <p class="text-muted mb-2">Area: 50 m²</p>
                        <p class="text-muted mb-2">Address: 456 Serenity Rd, City Center</p>
                        <div class="d-flex justify-content-between flex-lg-wrap">
                            <p class="text-dark fs-5 fw-bold">$300 / month</p>
                            <form action="/rental-detail" method="GET">
                                <input type="hidden" name="roomId" value="2">
                                <button type="submit" class="btn border border-secondary rounded-pill px-3 py-1 mb-4 text-primary">
                                    <i class="fas fa-eye me-2 text-primary"></i> View Details
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="border border-primary rounded position-relative vesitable-item">
                    <div class="vesitable-img">
                        <img src="img/fruite-item-3.jpg" class="img-fluid w-100 rounded-top" alt="Compact Studio">
                    </div>
                    <div class="text-white bg-primary px-3 py-1 rounded position-absolute" style="top: 10px; right: 10px;">Studio</div>
                    <div class="p-4 pb-0 rounded-bottom">
                        <h4>Compact Studio</h4>
                        <div class="d-flex mb-2">
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <span class="ms-2 text-muted">(3.5)</span>
                        </div>
                        <p class="text-muted mb-2">Area: 30 m²</p>
                        <p class="text-muted mb-2">Address: 789 Campus Ln, University Area</p>
                        <div class="d-flex justify-content-between flex-lg-wrap">
                            <p class="text-dark fs-5 fw-bold">$200 / month</p>
                            <form action="/rental-detail" method="GET">
                                <input type="hidden" name="roomId" value="3">
                                <button type="submit" class="btn border border-secondary rounded-pill px-3 py-1 mb-4 text-primary">
                                    <i class="fas fa-eye me-2 text-primary"></i> View Details
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="border border-primary rounded position-relative vesitable-item">
                    <div class="vesitable-img">
                        <img src="img/fruite-item-4.jpg" class="img-fluid w-100 rounded-top" alt="Shared Room">
                    </div>
                    <div class="text-white bg-primary px-3 py-1 rounded position-absolute" style="top: 10px; right: 10px;">Shared Room</div>
                    <div class="p-4 pb-0 rounded-bottom">
                        <h4>Shared Room</h4>
                        <div class="d-flex mb-2">
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star text-secondary"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <span class="ms-2 text-muted">(3.0)</span>
                        </div>
                        <p class="text-muted mb-2">Area: 20 m²</p>
                        <p class="text-muted mb-2">Address: 321 Peace St, Suburbs</p>
                        <div class="d-flex justify-content-between flex-lg-wrap">
                            <p class="text-dark fs-5 fw-bold">$100 / month</p>
                            <form action="/rental-detail" method="GET">
                                <input type="hidden" name="roomId" value="4">
                                <button type="submit" class="btn border border-secondary rounded-pill px-3 py-1 mb-4 text-primary">
                                    <i class="fas fa-eye me-2 text-primary"></i> View Details
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Rental Detail End -->
