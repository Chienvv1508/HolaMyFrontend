@page
@model HolaMyFrontend.Pages.HomePage.RegisterModel
@{
    ViewData["Title"] = "Đăng ký";
}

<div class="container-fluid py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="bg-light rounded p-4">
                    <h2 class="text-center mb-4">Đăng ký</h2>
                    <form id="register-form">
                        <div class="mb-3">
                            <label for="phoneNumber" class="form-label">Số điện thoại</label>
                            <input id="phoneNumber" class="form-control" placeholder="Số điện thoại" required />
                            <span id="phoneNumber-error" class="text-danger"></span>
                        </div>
                       
                        <div class="mb-3">
                            <label for="password" class="form-label">Mật khẩu</label>
                            <input id="password" type="password" class="form-control" placeholder="Mật khẩu" required minlength="6" />
                            <span id="password-error" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Nhập lại mật khẩu</label>
                            <input id="email" type="password" class="form-control" placeholder="Nhập lại mật khẩu" required />
                            <span id="email-error" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label for="firstName" class="form-label">Họ</label>
                            <input id="firstName" class="form-control" placeholder="Họ" required />
                            <span id="firstName-error" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label for="lastName" class="form-label">Tên</label>
                            <input id="lastName" class="form-control" placeholder="Tên" required />
                            <span id="lastName-error" class="text-danger"></span>
                        </div>
                        <div class="mb-3">
                            <label for="userType" class="form-label">Loại người dùng</label>
                            <select id="userType" class="form-select" required>
                                <option value="">Chọn loại người dùng</option>
                                <option value="Owner">Chủ trọ</option>
                                <option value="Tenant">Người thuê trọ</option>
                            </select>
                            <span id="userType-error" class="text-danger"></span>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 rounded-pill">Đăng ký</button>
                    </form>
                    <p class="text-center mt-3">
                        Đã có tài khoản? <a href="/Login" class="text-primary">Đăng nhập</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('register-form').addEventListener('submit', async function (e) {
            e.preventDefault();

            const phoneNumber = document.getElementById('phoneNumber').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const userType = document.getElementById('userType').value;

            try {
                const response = await fetch('https://your-api-url/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ phoneNumber, email, password, firstName, lastName, userType })
                });

                const data = await response.json();
                if (response.ok) {
                    localStorage.setItem('jwtToken', data.token);
                    window.location.href = '/';
                } else {
                    document.getElementById('phoneNumber-error').textContent = data.message || 'Đăng ký thất bại';
                }
            } catch (error) {
                document.getElementById('phoneNumber-error').textContent = 'Lỗi kết nối đến API';
            }
        });
    </script>
}
